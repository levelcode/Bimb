$(function(){function n(){var n=new Image;n.src=c[s],n.onload=function(){var t=n.width,e=(($(".canvas").width()-t)/2,r.getCenter());r.setOverlayImage(c[s],r.renderAll.bind(r),{top:30,left:e.left,originX:"center",originY:"top"}),n={}},s++,4==s&&(s=0)}function t(n){for(var t=atob(n.split(",")[1]),e=new ArrayBuffer(t.length),o=new Uint8Array(e),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);return new Blob([e],{type:"image/png"})}function e(){$(".canvas").height($(".canvas").width())}function o(n){var t=$(".canvas").width(),e="https://graph.facebook.com/"+n+"/picture?width="+t+"&height="+t;$("#img-load").attr("src",e),$("#img-load")[0].crossOrigin="Anonymous",$("#img-load").on("load",function(n){i()})}function i(){setTimeout(function(){"undefined"!=typeof window.instanceImg&&r.remove(window.instanceImg);var n=document.getElementById("img-load"),t=new fabric.Image(n,{left:0,top:0,angle:0,opacity:1,borderColor:"rgba(2, 0, 100, 0.9)",cornerColor:"rgba(2, 0, 100, 0.9)",transparentCorners:!1});window.instanceImg=t,r.add(t).setActiveObject(t),r.moveTo(t,-9999)},100)}function a(n,t){if(n.files&&n.files[0]){var e=new FileReader;e.onload=function(n){t.attr("src",n.target.result),t[0].crossOrigin="Anonymous",i()},e.readAsDataURL(n.files[0])}}var s=0,c=["../assets/texts/f1.png","../assets/texts/f2.png","../assets/texts/f3.png","../assets/texts/f4.png"];window.fbAsyncInit=function(){FB.init({appId:"274662929667884",xfbml:!0,version:"v2.9"}),FB.AppEvents.logPageView(),FB.getLoginStatus(function(n){"connected"==n.status&&o(n.authResponse.userID)})},function(n,t,e){var o,i=n.getElementsByTagName(t)[0];n.getElementById(e)||(o=n.createElement(t),o.id=e,o.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(o,i))}(document,"script","facebook-jssdk"),$(".btnc.profile-photo button").on("click",function(n){FB.login(function(n){n.authResponse&&FB.api("/me",function(n){o(n.id)})},{scope:"publish_actions"})}),$(".fb-btn.share button").on("click",function(n){FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":"https://riseandshine.ga","og:title":"Bimbo","og:description":"Rise and Shine","og:og:image:width":543,"og:image:height":543,"og:image":"https://riseandshine.ga/assets/logo.png"}})},function(n){console.log(n)})}),$(".fb-btn.publish button, .donwload button").on("click",function(n){var e=($(".canvas").width(),FB.getAccessToken(),r.toDataURL("image/jpeg",.98)),o=$(this),i=new Image;i.src=e,i.crossOrigin="Anonymous",i.onload=function(){var n=document.createElement("canvas"),e=543,a=e;n.width=e,n.height=a;var s=n.getContext("2d");s.drawImage(i,0,0,e,a);var c=n.toDataURL("image/jpeg",.98);blob=t(c);var r=new FormData;r.append("foto",blob),swal({title:"Loading...",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1}),$.ajax({url:"services/upload_photo.php",type:"POST",data:r,processData:!1,contentType:!1}).done(function(n){var t=window.location.origin+"/"+n;console.log(t),o.parent().hasClass("donwload")?window.open("services/donwload.php?url="+t,"_blank"):FB.getLoginStatus(function(n){"connected"==n.status?FB.api("/photos","post",{message:"photo description",url:t},function(n){console.log(n),swal({title:"Congratulations",text:" Your photo has been published",type:"success",confirmButtonColor:"#fb8f22"})}):(swal.close(),$(".btnc.profile-photo button").trigger("click"))})})}}),$(".btnc input.file").on("change",function(n){if("undefined"!=typeof this.files[0]){this.files[0];a(this,$(this).siblings("img"))}}),$(".btnc input.file").hover(function(){$(this).next().addClass("hover")},function(){$(this).next().removeClass("hover")}),$(window).on("resize",function(n){e()}),e();var r=new fabric.Canvas("canvas",{preserveObjectStacking:!0,selection:!1});fabric.Image.fromURL("../assets/background-canvas.png",function(n){r.add(n),r.moveTo(n,9999)},{left:0,top:0,angle:0,opacity:1,lockMovementX:!0,lockMovementY:!0,hasBorders:!1,hasControls:!1,evented:!1}),$(".btnc.change-msj button").on("click",function(t){n()}),n()});