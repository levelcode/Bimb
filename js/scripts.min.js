$(function(){function n(){var n=new Image;n.src=c[s],n.onload=function(){var e=n.width,t=(($(".canvas").width()-e)/2,r.getCenter());r.setOverlayImage(c[s],r.renderAll.bind(r),{top:30,left:t.left,originX:"center",originY:"top"}),n={}},s++,4==s&&(s=0)}function e(n){for(var e=atob(n.split(",")[1]),t=new ArrayBuffer(e.length),o=new Uint8Array(t),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);return new Blob([t],{type:"image/png"})}function t(){$(".canvas").height($(".canvas").width())}function o(n){var e=$(".canvas").width(),t="http://graph.facebook.com/"+n+"/picture?width="+e+"&height="+e;$("#img-load").attr("src",t),$("#img-load")[0].crossOrigin="Anonymous",$("#img-load").on("load",function(n){i()})}function i(){setTimeout(function(){"undefined"!=typeof window.instanceImg&&r.remove(window.instanceImg);var n=document.getElementById("img-load"),e=new fabric.Image(n,{left:0,top:0,angle:0,opacity:1,borderColor:"rgba(2, 0, 100, 0.9)",cornerColor:"rgba(2, 0, 100, 0.9)",transparentCorners:!1});window.instanceImg=e,r.add(e).setActiveObject(e),r.moveTo(e,-9999)},100)}function a(n,e){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(n){e.attr("src",n.target.result),e[0].crossOrigin="Anonymous",i()},t.readAsDataURL(n.files[0])}}var s=0,c=["../assets/texts/f1.png","../assets/texts/f2.png","../assets/texts/f3.png","../assets/texts/f4.png"];window.fbAsyncInit=function(){FB.init({appId:"274662929667884",xfbml:!0,version:"v2.9"}),FB.AppEvents.logPageView(),FB.getLoginStatus(function(n){"connected"==n.status&&o(n.authResponse.userID)})},function(n,e,t){var o,i=n.getElementsByTagName(e)[0];n.getElementById(t)||(o=n.createElement(e),o.id=t,o.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(o,i))}(document,"script","facebook-jssdk"),$(".btnc.profile-photo button").on("click",function(n){FB.login(function(n){n.authResponse&&FB.api("/me",function(n){o(n.id)})})}),$(".fb-btn button").on("click",function(n){var t=($(".canvas").width(),FB.getAccessToken(),r.toDataURL("image/jpeg",.98)),o=new Image;o.src=t,o.crossOrigin="Anonymous",o.onload=function(){var n=document.createElement("canvas"),t=543,i=t;n.width=t,n.height=i;var a=n.getContext("2d");a.drawImage(o,0,0,t,i);var s=n.toDataURL("image/jpeg",.98);blob=e(s);var c=new FormData;c.append("foto",blob),$.ajax({url:"services/upload_photo.php",type:"POST",data:c,processData:!1,contentType:!1}).done(function(n){console.log(window.location.origin+"/"+n),FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":"https://riseandshine.ga","og:title":"test","og:description":"test2","og:og:image:width":t,"og:image:height":t,"og:image":window.location.origin+"/"+n}})},function(n){console.log(n)})})}}),$(".btnc input.file").on("change",function(n){if("undefined"!=typeof this.files[0]){this.files[0];a(this,$(this).siblings("img"))}}),$(".btnc input.file").hover(function(){$(this).next().addClass("hover")},function(){$(this).next().removeClass("hover")}),$(window).on("resize",function(n){t()}),t();var r=new fabric.Canvas("canvas",{preserveObjectStacking:!0,selection:!1});fabric.Image.fromURL("../assets/background-canvas.png",function(n){r.add(n),r.moveTo(n,9999)},{left:0,top:0,angle:0,opacity:1,lockMovementX:!0,lockMovementY:!0,hasBorders:!1,hasControls:!1,evented:!1}),$(".photo .canvas .canvas-container").on("click",function(e){n()}),n()});