$(function(){function t(){var t=new Image;t.src=c[s],t.onload=function(){var n=t.width,e=(($(".canvas").width()-n)/2,r.getCenter());r.setOverlayImage(c[s],r.renderAll.bind(r),{top:30,left:e.left,originX:"center",originY:"top"}),t={}},s++,4==s&&(s=0)}function n(t){for(var n=atob(t.split(",")[1]),e=new ArrayBuffer(n.length),o=new Uint8Array(e),i=0;i<n.length;i++)o[i]=n.charCodeAt(i);return new Blob([e],{type:"image/png"})}function e(){$(".canvas").height($(".canvas").width())}function o(t){var n=543,e="https://graph.facebook.com/"+t+"/picture?width="+n+"&height="+n,e="https://graph.facebook.com/100018373652787/picture?width=543&height=543";$("#img-load").attr("src",e),$("#img-load")[0].crossOrigin="Anonymous",$("#img-load").on("load",function(t){i()})}function i(){setTimeout(function(){"undefined"!=typeof window.instanceImg&&r.remove(window.instanceImg);var t=document.getElementById("img-load"),n=new fabric.Image(t,{left:0,top:0,angle:0,opacity:1,borderColor:"rgba(2, 0, 100, 0.9)",cornerColor:"rgba(2, 0, 100, 0.9)",transparentCorners:!1});window.instanceImg=n,r.add(n).setActiveObject(n),r.moveTo(n,-9999)},100)}function a(t,n){if(t.files&&t.files[0]){var e=new FileReader;e.onload=function(t){n.attr("src",t.target.result),n[0].crossOrigin="Anonymous",i()},e.readAsDataURL(t.files[0])}}var s=0,c=["../assets/texts/f1.png","../assets/texts/f2.png","../assets/texts/f3.png","../assets/texts/f4.png"];window.fbAsyncInit=function(){FB.init({appId:"274662929667884",xfbml:!0,version:"v2.9"}),FB.AppEvents.logPageView(),FB.getLoginStatus(function(t){"connected"==t.status&&o(t.authResponse.userID)})},function(t,n,e){var o,i=t.getElementsByTagName(n)[0];t.getElementById(e)||(o=t.createElement(n),o.id=e,o.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(o,i))}(document,"script","facebook-jssdk"),$(".btnc.profile-photo button").on("click",function(t){FB.login(function(t){t.authResponse&&FB.api("/me",function(t){o(t.id)})},{scope:"publish_actions"})}),$(".fb-btn.share button").on("click",function(t){FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":"https://riseandshine.ga","og:title":"Bimbo","og:description":"Rise and Shine","og:og:image:width":543,"og:image:height":543,"og:image":"https://riseandshine.ga/assets/logo.png"}})},function(t){console.log(t)})}),$(".fb-btn.publish button, .donwload button").on("click",function(t){var e=($(".canvas").width(),FB.getAccessToken(),r.toDataURL("image/jpeg",.98)),o=$(this),i=new Image;i.src=e,i.crossOrigin="Anonymous",i.onload=function(){var t=document.createElement("canvas"),e=543,a=e;t.width=e,t.height=a;var s=t.getContext("2d");s.drawImage(i,0,0,e,a);var c=t.toDataURL("image/jpeg",.98);blob=n(c);var r=new FormData;r.append("foto",blob),swal({title:"Loading...",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1}),$.ajax({url:"services/upload_photo.php",type:"POST",data:r,processData:!1,contentType:!1}).done(function(t){var n=window.location.origin+"/"+t;console.log(n),o.parent().hasClass("donwload")?window.open("services/donwload.php?url="+n,"_blank"):FB.getLoginStatus(function(t){"connected"==t.status?FB.api("/photos","post",{message:"photo description",url:n},function(t){console.log(t),swal({title:"Congratulations",text:" Your photo has been published",type:"success",confirmButtonColor:"#fb8f22"})}):(swal.close(),$(".btnc.profile-photo button").trigger("click"))})})}}),$(".btnc input.file").on("change",function(t){if("undefined"!=typeof this.files[0]){this.files[0];a(this,$(this).siblings("img"))}}),$(".btnc input.file").hover(function(){$(this).next().addClass("hover")},function(){$(this).next().removeClass("hover")}),$(window).on("resize",function(t){e()}),e();var r=new fabric.Canvas("canvas",{preserveObjectStacking:!0,selection:!1});fabric.Image.fromURL("../assets/background-canvas.png",function(t){r.add(t),r.moveTo(t,9999)},{left:0,top:0,angle:0,opacity:1,lockMovementX:!0,lockMovementY:!0,hasBorders:!1,hasControls:!1,evented:!1}),$(".btnc.change-msj button").on("click",function(n){t()}),t()});